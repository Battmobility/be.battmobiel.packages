{"version":3,"file":"sofico-framework-ui-kit-components-input-wrapper.js","sources":["../../../../projects/sofico-framework/ui-kit/components/input-wrapper/input-wrapper.component.ts","../../../../projects/sofico-framework/ui-kit/components/input-wrapper/input-wrapper.module.ts","../../../../projects/sofico-framework/ui-kit/components/input-wrapper/sofico-framework-ui-kit-components-input-wrapper.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  AfterContentInit,\n  Component,\n  ContentChildren,\n  Input,\n  OnDestroy,\n  Optional,\n  QueryList\n} from '@angular/core';\nimport { AbstractControl, FormControl } from '@angular/forms';\nimport { FormComponent } from '@sofico-framework/ui-kit/components/form';\nimport { InputDirective } from '@sofico-framework/ui-kit/components/input';\nimport { isObject } from '@sofico-framework/utils';\nimport { takeUntilDestroy, UntilDestroy } from 'ngx-reactivetoolkit';\nimport { Observable } from 'rxjs';\nimport {\n  debounceTime,\n  filter,\n  map,\n  startWith,\n  switchMap,\n  tap\n} from 'rxjs/operators';\nimport { FormErrorMessage } from './types/form-error-message.type';\n\n@UntilDestroy()\n@Component({\n  selector: 'sof-input-wrapper',\n  template: `\n    <div class=\"form-group\">\n      <label\n        *ngIf=\"!(label | sofIsNullOrUndefined)\"\n        class=\"sb-form-control-wrapper-label\"\n      >\n        {{ label }}\n        <ng-container *ngIf=\"required$ | async\"> *</ng-container>\n      </label>\n\n      <div>\n        <ng-content></ng-content>\n      </div>\n      <small *ngIf=\"hint?.length > 0\" class=\"form-text text-muted\">\n        {{ hint }}\n      </small>\n      <ng-container *ngIf=\"errorMessages$ | async as errorMessages\">\n        <ul\n          *ngIf=\"\n            errorMessages?.length > 0 &&\n            ((control$ | async)?.touched || form?.submitted)\n          \"\n        >\n          <ng-container *ngFor=\"let message of errorMessages\">\n            <li class=\"invalid-feedback\" [style.display]=\"'block'\">\n              {{ tc + '.' + message.value | translate: message.params }}\n            </li>\n          </ng-container>\n        </ul>\n      </ng-container>\n    </div>\n  `,\n  styleUrls: ['./input-wrapper.component.scss']\n})\nexport class InputWrapperComponent implements AfterContentInit, OnDestroy {\n  /**\n   * The label will be displayed above the input field.\n   */\n  @Input() label: string;\n\n  /**\n   * The hint is used to add some extra information below the input field.\n   */\n  @Input() hint: string;\n\n  tc: string;\n  errorMessages$: Observable<FormErrorMessage[]>;\n  control$: Observable<AbstractControl>;\n  required$: Observable<boolean>;\n\n  @ContentChildren(InputDirective) children: QueryList<any>;\n\n  constructor(\n    @Optional()\n    public form: FormComponent\n  ) {}\n\n  ngOnDestroy(): void {}\n\n  ngAfterContentInit(): void {\n    this.tc = this.form?.tc;\n    // we need a trigger when the formgroup adds or removes controls\n    const trigger$ = this.form.formGroup.valueChanges.pipe(startWith(null));\n    this.control$ = trigger$.pipe(\n      switchMap(() =>\n        this.children.changes\n          .pipe(\n            startWith(this.children),\n            debounceTime(0) // children is not updated yet by angular\n          )\n          .pipe(\n            filter(children => children?.length > 0), // ignore if no children\n            // this is to allow radiobuttons\n            map(children => [\n              ...new Set<FormControl>(children.map(v => v.formControl))\n            ]),\n            tap(children => {\n              // throw error if length of distincted children is different then 1\n              if (children.length !== 1) {\n                throw new Error(\n                  'A sof-input-wrapper component can only contain one InputDirective (unless its a radiobutton)'\n                );\n              }\n            }),\n            map(children => children[0]) // only one distinct control supported\n          )\n      ),\n      takeUntilDestroy(this)\n    );\n    this.required$ = this.control$.pipe(\n      map(\n        control =>\n          control?.validator &&\n          control?.validator(new FormControl(''))?.required === true\n      )\n    );\n    this.errorMessages$ = this.control$.pipe(\n      switchMap(control => {\n        return control?.statusChanges.pipe(\n          startWith(control.status),\n          map(status =>\n            this.mapErrorObjToMessages(control.errors, this.form.actualErrorMap)\n          )\n        );\n      })\n    );\n  }\n\n  private mapErrorObjToMessages(\n    obj: { [key: string]: any },\n    errorMap: { [key: string]: string }\n  ): FormErrorMessage[] {\n    return (\n      errorMap &&\n      obj &&\n      Object.keys(obj).map(k => {\n        const params = obj[k];\n        return {\n          value: errorMap[k],\n          params: isObject(params) ? params : null\n        };\n      })\n    );\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { UtilsPipesModule } from '@sofico-framework/utils';\nimport { InputWrapperComponent } from './input-wrapper.component';\n\n@NgModule({\n  imports: [CommonModule, UtilsPipesModule, TranslateModule],\n  declarations: [InputWrapperComponent],\n  exports: [InputWrapperComponent]\n})\nexport class InputWrapperModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"]}