!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/forms"),require("@sofico-framework/ui-kit/components/form"),require("@sofico-framework/ui-kit/directives/focus"),require("ngx-reactivetoolkit"),require("rxjs"),require("rxjs/operators"),require("@angular/common"),require("@ngx-translate/core"),require("@sofico-framework/ui-kit/components/svg-icon")):"function"==typeof define&&define.amd?define("@sofico-framework/ui-kit/components/input-file",["exports","@angular/core","@angular/forms","@sofico-framework/ui-kit/components/form","@sofico-framework/ui-kit/directives/focus","ngx-reactivetoolkit","rxjs","rxjs/operators","@angular/common","@ngx-translate/core","@sofico-framework/ui-kit/components/svg-icon"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self)["sofico-framework"]=t["sofico-framework"]||{},t["sofico-framework"]["ui-kit"]=t["sofico-framework"]["ui-kit"]||{},t["sofico-framework"]["ui-kit"].components=t["sofico-framework"]["ui-kit"].components||{},t["sofico-framework"]["ui-kit"].components["input-file"]={}),t.ng.core,t.ng.forms,t["sofico-framework"]["ui-kit"].components.form,t["sofico-framework"]["ui-kit"].directives.focus,t.ngxReactivetoolkit,t.rxjs,t.rxjs.operators,t.ng.common,t.core$1,t["sofico-framework"]["ui-kit"].components["svg-icon"])}(this,(function(t,e,o,n,i,r,a,p,s,l,u){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */Object.create;var c;Object.create;t.InputFileComponent=c=function(){function t(t,o){this.form=t,this.ngControl=o,this.placeholder="",this.acceptedMimeTypes=["application/pdf","image/jpeg","image/x-png"],this.changeValue=new e.EventEmitter,this.touch=new e.EventEmitter,this.internalValue=null,o&&(o.valueAccessor=this)}return Object.defineProperty(t.prototype,"value",{set:function(t){this.writeValue(t)},enumerable:!1,configurable:!0}),t.prototype.sofFocus=function(){this.btnElement.nativeElement.focus()},t.prototype.ngOnInit=function(){this.dropAreaDropEvent$=this.getDropEvent$(this.dropArea.nativeElement,"drop"),this.dropAreaDragEnterEvent$=this.getDropEvent$(this.dropArea.nativeElement,"dragenter"),this.dropAreaDragOverEvent$=this.getDropEvent$(this.dropArea.nativeElement,"dragover"),this.dropAreaDragLeaveEvent$=this.getDropEvent$(this.dropArea.nativeElement,"dragleave"),this.highlight$=this.getHighlight$(),this.droppedFiles$=this.getDroppedFiles$()},t.prototype.ngAfterViewInit=function(){var t=this;this.droppedFiles$.pipe(r.takeUntilDestroy(this)).subscribe((function(e){t.onChange(e)}))},t.prototype.ngOnDestroy=function(){var t;(null===(t=this.ngControl)||void 0===t?void 0:t.valueAccessor)&&(this.ngControl.valueAccessor.writeValue=function(){})},t.prototype.registerOnChange=function(t){this.propagateChange=t},t.prototype.registerOnTouched=function(t){this.propagateTouch=t},t.prototype.writeValue=function(t){this.internalValue=null!=t?t:null},t.prototype.onChange=function(t){if(!this.isDisabled&&t){var e=null!=t?t:null;this.changeValue.emit(e),this.propagateChange&&(this.internalValue=e,this.propagateChange(e))}},t.prototype.onTouch=function(){this.flagPositiveClick?this.flagPositiveClick=!1:(this.touch.emit(),!this.isDisabled&&this.propagateTouch&&this.propagateTouch())},t.prototype.setDisabledState=function(t){this.isDisabled=t},t.prototype.lockOutOnTouch=function(){this.flagPositiveClick=!0},t.prototype.getDroppedFiles$=function(){var t=this;return this.dropAreaDropEvent$.pipe(p.map((function(t){return t.dataTransfer.files})),p.filter((function(e){return t.multiple?e.length>0:1===e.length})),p.filter((function(e){return Array.from(e).every((function(e){return t.acceptedMimeTypes.includes(e.type)}))})))},t.prototype.getHighlight$=function(){return a.merge(a.merge(this.dropAreaDragEnterEvent$,this.dropAreaDragOverEvent$).pipe(p.mapTo(!0)),a.merge(this.dropAreaDropEvent$,this.dropAreaDragLeaveEvent$).pipe(p.mapTo(!1))).pipe(p.distinctUntilChanged(),p.debounce((function(t){return t?a.EMPTY:a.timer(100)})),p.distinctUntilChanged())},t.prototype.getDropEvent$=function(t,e){return a.fromEvent(t,e).pipe(p.tap((function(t){t.preventDefault(),t.stopPropagation()})))},t}(),t.InputFileComponent.decorators=[{type:e.Component,args:[{selector:"sof-input-file",template:'\n    <div #dropArea class="input-group" [class.highlight]="highlight$ | async">\n      <input\n        type="text"\n        class="form-control"\n        [value]="\n          internalValue?.length === 1\n            ? internalValue[0]?.name\n            : internalValue?.length > 1\n            ? (tc + \'.FILES-SELECTED-COUNT\'\n              | translate: { count: internalValue?.length })\n            : this.multiple\n            ? (tc + \'.NO-FILES-SELECTED\' | translate)\n            : (tc + \'.NO-FILE-SELECTED\' | translate)\n        "\n        [attr.id]="labelForId"\n        [readOnly]="true"\n        [class.is-invalid]="\n          invalid ||\n          (ngControl?.invalid && (ngControl?.touched || form?.submitted))\n        "\n        [placeholder]="placeholder"\n        (blur)="onTouch()"\n        (click)="lockOutOnTouch(); fileInput.click()"\n      />\n      <div class="input-group-append">\n        <button\n          #btnElement\n          type="button"\n          class="btn btn-action"\n          [disabled]="isDisabled"\n          [class.is-invalid]="\n            invalid ||\n            (ngControl?.invalid && (ngControl?.touched || form?.submitted))\n          "\n          (blur)="onTouch()"\n          (click)="lockOutOnTouch(); fileInput.click()"\n        >\n          <sof-svg-icon icon="icon-folder"></sof-svg-icon>\n        </button>\n      </div>\n    </div>\n    <input\n      #fileInput\n      type="file"\n      class="d-none"\n      [attr.multiple]="multiple"\n      [attr.accept]="acceptedMimeTypes"\n      [disabled]="isDisabled"\n      (input)="onChange($event.target?.files)"\n    />\n  ',providers:[{provide:i.SOF_FOCUS_COMPONENT,useExisting:c}],styles:[".highlight input{border-left-color:#343a40}.highlight .input-group-append button,.highlight input{background-color:#f8f9fa;border-top-color:#343a40;border-bottom-color:#343a40}.highlight .input-group-append button{border-right-color:#343a40}.input-group input{border-right:unset;cursor:default}.input-group.is-invalid:focus-within,.input-group:focus-within{outline:0}.input-group:focus-within .input-group-append .btn{box-shadow:unset;border-left-color:transparent}.input-group .form-control:focus{box-shadow:unset}.input-group .form-control.is-invalid:focus{border-right-color:transparent;box-shadow:unset}button{color:#555;cursor:pointer;display:flex;justify-content:center;border-top:1px solid #ced4da;border-bottom:1px solid #ced4da;border-right:1px solid #ced4da;align-items:center;background:#fff}button.btn.focus,button.btn:focus{box-shadow:none}:host{display:flex}:host .form-control.is-invalid,:host .was-validated .form-control:invalid{background-position:right 10px center}"]}]}],t.InputFileComponent.ctorParameters=function(){return[{type:n.FormComponent,decorators:[{type:e.Optional}]},{type:o.NgControl,decorators:[{type:e.Optional},{type:e.Host}]}]},t.InputFileComponent.propDecorators={tc:[{type:e.Input}],labelForId:[{type:e.Input}],placeholder:[{type:e.Input}],isDisabled:[{type:e.Input}],invalid:[{type:e.Input}],droppable:[{type:e.Input}],multiple:[{type:e.Input}],acceptedMimeTypes:[{type:e.Input}],value:[{type:e.Input}],changeValue:[{type:e.Output}],touch:[{type:e.Output}],dropArea:[{type:e.ViewChild,args:["dropArea",{static:!0}]}],btnElement:[{type:e.ViewChild,args:["btnElement"]}]},t.InputFileComponent=c=function(t,e,o,n){var i,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(i=t[p])&&(a=(r<3?i(a):r>3?i(e,o,a):i(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a}([r.UntilDestroy()],t.InputFileComponent);var f=function(){};f.decorators=[{type:e.NgModule,args:[{imports:[s.CommonModule,u.SvgIconModule,l.TranslateModule],declarations:[t.InputFileComponent],exports:[t.InputFileComponent]}]}],t.InputFileModule=f,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=sofico-framework-ui-kit-components-input-file.umd.min.js.map