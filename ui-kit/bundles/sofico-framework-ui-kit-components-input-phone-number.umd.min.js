!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("@angular/core"),require("@angular/forms"),require("@sofico-framework/ui-kit/components/form"),require("@sofico-framework/ui-kit/directives/focus"),require("google-libphonenumber"),require("@angular/common"),require("@sofico-framework/ui-kit/components/input-single-select")):"function"==typeof define&&define.amd?define("@sofico-framework/ui-kit/components/input-phone-number",["exports","@angular/core","@angular/forms","@sofico-framework/ui-kit/components/form","@sofico-framework/ui-kit/directives/focus","google-libphonenumber","@angular/common","@sofico-framework/ui-kit/components/input-single-select"],o):o(((e="undefined"!=typeof globalThis?globalThis:e||self)["sofico-framework"]=e["sofico-framework"]||{},e["sofico-framework"]["ui-kit"]=e["sofico-framework"]["ui-kit"]||{},e["sofico-framework"]["ui-kit"].components=e["sofico-framework"]["ui-kit"].components||{},e["sofico-framework"]["ui-kit"].components["input-phone-number"]={}),e.ng.core,e.ng.forms,e["sofico-framework"]["ui-kit"].components.form,e["sofico-framework"]["ui-kit"].directives.focus,e.googleLibphonenumber,e.ng.common,e["sofico-framework"]["ui-kit"].components["input-single-select"])}(this,(function(e,o,n,t,i,r,l,u){"use strict";var a=r.PhoneNumberUtil.getInstance();function s(e,o){if(e&&o)try{return a.parseAndKeepRawInput(o,e)}catch(e){}return null}var c=function(){function e(e,t){this.form=e,this.ngControl=t,this.placeholder="",this.changeValue=new o.EventEmitter,this.phoneUtil=r.PhoneNumberUtil.getInstance(),this.phoneNumber=null,this.singleSelectFormControl=new n.FormControl(null),this.internalValue={countryCodeISO2:null,localCode:null},this.selectorLabel=function(e){return"+"+e.countryPhoneCode+" ("+e.countryCodeISO3+")"},this.selectorValue=function(e){return e.countryCodeISO2},t&&(t.valueAccessor=this)}return Object.defineProperty(e.prototype,"isDisabled",{set:function(e){this.setDisabledState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{set:function(e){this.writeValue(e)},enumerable:!1,configurable:!0}),e.prototype.sofFocus=function(){this.inputElement.nativeElement.focus()},e.prototype.ngOnDestroy=function(){var e;(null===(e=this.ngControl)||void 0===e?void 0:e.valueAccessor)&&(this.ngControl.valueAccessor.writeValue=function(){})},e.prototype.registerOnChange=function(e){this.propagateChange=e},e.prototype.registerOnTouched=function(e){this.propagateTouch=e},e.prototype.writeValue=function(e){var o,n;this.internalValue={countryCodeISO2:null!==(o=null==e?void 0:e.countryCodeISO2)&&void 0!==o?o:null,localCode:null!==(n=null==e?void 0:e.localCode)&&void 0!==n?n:null},this.singleSelectFormControl.setValue(this.internalValue.countryCodeISO2),this.phoneNumber=s(this.internalValue.countryCodeISO2,this.internalValue.localCode)},e.prototype.setDisabledState=function(e){this.internalDisabled=e,e?this.singleSelectFormControl.disable():this.singleSelectFormControl.enable()},e.prototype.onChangeCountryCode=function(e){this.isDisabled||(this.phoneNumber=s(e,this.internalValue.localCode),this.emitAndPropagate(e,this.internalValue.localCode))},e.prototype.onChangeLocalCode=function(e){this.isDisabled||(this.phoneNumber=s(this.internalValue.countryCodeISO2,e),this.emitAndPropagate(this.internalValue.countryCodeISO2,e))},e.prototype.onTouch=function(e){void 0===e&&(e=!0),this.phoneNumber&&(this.internalValue=this.formatPhoneNumber(this.internalValue,this.phoneNumber)),!this.isDisabled&&this.propagateTouch&&e&&this.propagateTouch()},e.prototype.formatPhoneNumber=function(e,o){return Object.assign(Object.assign({},e),{localCode:this.phoneUtil.format(o,r.PhoneNumberFormat.NATIONAL)})},e.prototype.emitAndPropagate=function(e,o){var n,t,i,r=null!=e?e:null,l=null!=o?o:null,u=null!==(i=null===(t=null===(n=this.phoneNumber)||void 0===n?void 0:n.getNationalNumber())||void 0===t?void 0:t.toString())&&void 0!==i?i:l,a=null===l||""===l||null===r;a?this.changeValue.emit(null):this.changeValue.emit({countryCodeISO2:r,localCode:u}),this.propagateChange&&(this.internalValue={countryCodeISO2:r,localCode:l},a?this.propagateChange(null):this.propagateChange(Object.assign(Object.assign({},this.internalValue),{localCode:u})))},e}();c.decorators=[{type:o.Component,args:[{selector:"sof-input-phone-number",encapsulation:o.ViewEncapsulation.None,template:'\n    <div class="input-group">\n      <div class="input-group-prepend">\n        <sof-input-single-select\n          [tc]="tc"\n          [formControl]="singleSelectFormControl"\n          [labelForId]="labelForId"\n          [options]="countries"\n          [selectorLabel]="selectorLabel"\n          [selectorValue]="selectorValue"\n          [clearable]="false"\n          [isDisabled]="internalDisabled"\n          [invalid]="\n            invalid ||\n            (ngControl?.invalid && (ngControl?.touched || form?.submitted))\n          "\n          (touch)="onTouch(false)"\n          (changeValue)="onChangeCountryCode($event)"\n        ></sof-input-single-select>\n      </div>\n      <input\n        #inputElement\n        type="text"\n        class="form-control"\n        [class.is-invalid]="\n          invalid ||\n          (ngControl?.invalid && (ngControl?.touched || form?.submitted))\n        "\n        [attr.disabled]="internalDisabled"\n        [placeholder]="placeholder"\n        [value]="internalValue.localCode"\n        (blur)="onTouch()"\n        (input)="onChangeLocalCode($event.target?.value)"\n      />\n    </div>\n  ',providers:[{provide:i.SOF_FOCUS_COMPONENT,useExisting:c}],styles:["sof-input-phone-number sof-input-single-select{min-width:125px}sof-input-phone-number .input-group-prepend:focus-within+.form-control,sof-input-phone-number .input-group-prepend:hover+.form-control{z-index:-1}"]}]}],c.ctorParameters=function(){return[{type:t.FormComponent,decorators:[{type:o.Optional}]},{type:n.NgControl,decorators:[{type:o.Optional},{type:o.Host}]}]},c.propDecorators={tc:[{type:o.Input}],labelForId:[{type:o.Input}],isDisabled:[{type:o.Input}],placeholder:[{type:o.Input}],countries:[{type:o.Input}],invalid:[{type:o.Input}],value:[{type:o.Input}],changeValue:[{type:o.Output}],inputElement:[{type:o.ViewChild,args:["inputElement"]}]};var p=function(){};p.decorators=[{type:o.NgModule,args:[{imports:[l.CommonModule,u.InputSingleSelectModule,n.ReactiveFormsModule],declarations:[c],exports:[c]}]}];var d=r.PhoneNumberUtil.getInstance();e.InputPhoneNumberComponent=c,e.InputPhoneNumberModule=p,e.calculatePhoneNumber=s,e.phoneNumberValidator=function(e){var o,n,t,i;if(!(null===(o=null==e?void 0:e.value)||void 0===o?void 0:o.localCode))return null;var r=s(null===(n=null==e?void 0:e.value)||void 0===n?void 0:n.countryCodeISO2,null===(t=null==e?void 0:e.value)||void 0===t?void 0:t.localCode);return r&&d.isValidNumberForRegion(r,null===(i=e.value)||void 0===i?void 0:i.countryCodeISO2)?null:{phoneNumber:!0}},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=sofico-framework-ui-kit-components-input-phone-number.umd.min.js.map