!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/router"),require("@sofico-framework/ui-kit/directives/focus"),require("@sofico-framework/utils"),require("ngx-reactivetoolkit"),require("rxjs"),require("rxjs/operators"),require("@angular/common"),require("@ngx-translate/core"),require("@sofico-framework/ui-kit/components/in-view"),require("@sofico-framework/ui-kit/components/loading"),require("@sofico-framework/ui-kit/components/overview-list-group-filter"),require("@sofico-framework/ui-kit/components/overview-list-search-bar"),require("@sofico-framework/ui-kit/components/overview-list-sort-dropdown"),require("@angular/cdk/a11y"),require("@sofico-framework/ui-kit/classes")):"function"==typeof define&&define.amd?define("@sofico-framework/ui-kit/components/overview-list",["exports","@angular/core","@angular/router","@sofico-framework/ui-kit/directives/focus","@sofico-framework/utils","ngx-reactivetoolkit","rxjs","rxjs/operators","@angular/common","@ngx-translate/core","@sofico-framework/ui-kit/components/in-view","@sofico-framework/ui-kit/components/loading","@sofico-framework/ui-kit/components/overview-list-group-filter","@sofico-framework/ui-kit/components/overview-list-search-bar","@sofico-framework/ui-kit/components/overview-list-sort-dropdown","@angular/cdk/a11y","@sofico-framework/ui-kit/classes"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self)["sofico-framework"]=e["sofico-framework"]||{},e["sofico-framework"]["ui-kit"]=e["sofico-framework"]["ui-kit"]||{},e["sofico-framework"]["ui-kit"].components=e["sofico-framework"]["ui-kit"].components||{},e["sofico-framework"]["ui-kit"].components["overview-list"]={}),e.ng.core,e.ng.router,e["sofico-framework"]["ui-kit"].directives.focus,e.utils,e.ngxReactivetoolkit,e.rxjs,e.rxjs.operators,e.ng.common,e.core,e["sofico-framework"]["ui-kit"].components["in-view"],e["sofico-framework"]["ui-kit"].components.loading,e["sofico-framework"]["ui-kit"].components["overview-list-group-filter"],e["sofico-framework"]["ui-kit"].components["overview-list-search-bar"],e["sofico-framework"]["ui-kit"].components["overview-list-sort-dropdown"],e.ng.cdk.a11y,e["sofico-framework"]["ui-kit"].classes)}(this,(function(e,t,o,n,i,r,s,c,a,u,l,p,f,h,m,d,v){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */Object.create;function g(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,i,r=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(o=r.return)&&o.call(r)}finally{if(i)throw i.error}}return s}var y;Object.create;e.OverviewListComponent=y=function(){function e(e,o){this.router=e,this.activatedRoute=o,this.thresholdNumberOfItems=15,this.enableSearch=!0,this.enableSorting=!0,this.retainGroupSelection=!0,this.searchedEntities=new t.EventEmitter,this.entities$=new s.ReplaySubject(1),this.config$=new s.ReplaySubject(1),this.sortingSub$=new s.ReplaySubject(1),this.termSub$=new s.BehaviorSubject(""),this.numberOfItemsToDisplaySub$=new s.BehaviorSubject(this.thresholdNumberOfItems),this.selectedGroupSub$=new s.BehaviorSubject(null),this.trackByFn=function(e){return e}}return Object.defineProperty(e.prototype,"config",{set:function(e){e&&(this.config$.next(e),this.sortingSub$.next(e.initialSorting),this.searchableSelectors=e.functionalProps.filter((function(e){return e.searchable})).map((function(e){return e.selector})))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"entities",{set:function(e){e&&this.entities$.next(e)},enumerable:!1,configurable:!0}),e.prototype.sofFocus=function(){var e;this.enableSearch?this.searchBarComponent.sofFocus():null===(e=this.listComponents.first)||void 0===e||e.sofFocus()},e.prototype.ngOnInit=function(){var e,t=this;if(this.searchedEntities$=this.getSearchedEntities$(),this.groupedEntities$=this.getGroupedEntities$(),this.sortedEntities$=this.getSortedEntities$(),this.searchedEntities$.pipe(r.takeUntilDestroy(this)).subscribe((function(e){return t.searchedEntities.emit(e)})),this.filteredEntities$=this.sortedEntities$,this.hasFilteredEntities$=this.getHasFilteredEntities$(),(null===(e=this.groupDefinitions)||void 0===e?void 0:e.length)>0){var o=this.activatedRoute.snapshot.queryParamMap.get("tab");o?this.selectedGroupSub$.next(this.groupDefinitions.find((function(e){return e.id===o}))):this.selectedGroupSub$.next(this.groupDefinitions[0])}else this.selectedGroupSub$.next(null);this.setupQueryParamSubscription()},e.prototype.ngOnDestroy=function(){},e.prototype.onChangeSorting=function(e){this.sortingSub$.next(e),this.numberOfItemsToDisplaySub$.next(this.thresholdNumberOfItems)},e.prototype.onChangeTerm=function(e){this.termSub$.next(e),this.numberOfItemsToDisplaySub$.next(this.thresholdNumberOfItems)},e.prototype.onChangeGroup=function(e){this.selectedGroupSub$.next(e),this.numberOfItemsToDisplaySub$.next(this.thresholdNumberOfItems)},e.prototype.onInView=function(e){e&&this.numberOfItemsToDisplaySub$.next(this.numberOfItemsToDisplaySub$.getValue()+this.thresholdNumberOfItems)},e.prototype.getSearchedEntities$=function(){var e=this;return this.entities$.pipe(c.switchMap((function(t){return e.enableSearch&&0!==e.searchableSelectors.length?s.of(t).pipe(i.search(e.termSub$,e.searchableSelectors)):s.of(t)})),c.shareReplay({refCount:!0,bufferSize:1}))},e.prototype.getGroupedEntities$=function(){var e=this;return s.combineLatest([this.searchedEntities$,this.selectedGroupSub$]).pipe(c.map((function(t){var o=g(t,2),n=o[0],i=o[1];return i&&(i.hasOwnProperty("groupIdentifiers")||i.hasOwnProperty("groupIdentifiersIncl")||i.hasOwnProperty("groupIdentifiersExcl"))?null==n?void 0:n.filter((function(t){var o,n,r,s=e.groupSelector(t),c=i;if(i.hasOwnProperty("groupIdentifiers")?n=c.groupIdentifiers:(n=c.groupIdentifiersIncl,r=c.groupIdentifiersExcl),Array.isArray(s)){var a=c.groupIdentifiersInclStrategy,u=c.groupIdentifiersExclStrategy,l=function(e){return s.includes(e)};return(null===(o=void 0===a||"or"===a?null==n?void 0:n.some(l):null==n?void 0:n.every(l))||void 0===o||o)&&(void 0===u||"or"===u?!(null==r?void 0:r.some(l)):!(null==r?void 0:r.every(l)))}return(null==n?void 0:n.includes(s))&&!(null==r?void 0:r.includes(s))})):n})))},e.prototype.getSortedEntities$=function(){return s.combineLatest([this.groupedEntities$,this.sortingSub$,this.numberOfItemsToDisplaySub$]).pipe(c.map((function(e){var t=g(e,3),o=t[0],n=t[1],r=t[2];return i.sortList(o,n).slice(0,r)})))},e.prototype.getHasFilteredEntities$=function(){return this.filteredEntities$.pipe(c.map((function(e){return(null==e?void 0:e.length)>0})),c.shareReplay({refCount:!0,bufferSize:1}))},e.prototype.setupQueryParamSubscription=function(){var e=this;this.selectedGroupSub$.pipe(c.skip(1),c.map((function(e){return null==e?void 0:e.id})),c.filter((function(e){return!!e})),c.distinctUntilChanged(),r.takeUntilDestroy(this)).subscribe((function(t){e.retainGroupSelection&&e.router.navigate([],{relativeTo:e.activatedRoute,queryParams:{tab:t},queryParamsHandling:"merge",replaceUrl:!0})}))},e}(),e.OverviewListComponent.decorators=[{type:t.Component,args:[{selector:"sof-overview-list",changeDetection:t.ChangeDetectionStrategy.OnPush,template:'\n    <ng-container *ngIf="config$ | async as config">\n      <div *ngIf="enableSearch || enableSorting" class="row">\n        <div\n          *ngIf="enableSearch"\n          [ngClass]="enableSorting ? \'col-lg-8 col-md-6 col-sm-12\' : \'col-12\'"\n        >\n          <sof-overview-list-search-bar\n            #searchBarComponent\n            [tc]="tc"\n            (changeTerm)="onChangeTerm($event)"\n          ></sof-overview-list-search-bar>\n        </div>\n        <div\n          *ngIf="enableSorting"\n          [ngClass]="\n            enableSearch\n              ? \'col-lg-4 col-md-6 col-sm-12\'\n              : \'col-lg-4 offset-lg-8  col-md-12 col-sm-12\'\n          "\n        >\n          <sof-overview-list-sort-dropdown\n            [tc]="tc"\n            [sorting]="sortingSub$ | async"\n            [overviewListConfig]="config"\n            (changeSorting)="onChangeSorting($event)"\n          ></sof-overview-list-sort-dropdown>\n        </div>\n      </div>\n      <div *ngIf="groupDefinitions" class="row">\n        <sof-overview-list-group-tabs\n          [tc]="tc"\n          class="col-lg-12 col-md-12 col-sm-12 mb-3"\n          [entities]="searchedEntities$ | async"\n          [selectedGroup]="selectedGroupSub$ | async"\n          [groupDefinitions]="groupDefinitions"\n          [groupSelector]="groupSelector"\n          (selectGroup)="onChangeGroup($event)"\n        ></sof-overview-list-group-tabs>\n      </div>\n      <ng-container *ngIf="hasFilteredEntities$ | async; else noResults">\n        <sof-in-view [preloadHeight]="500" (inView)="onInView($event)">\n          <sof-overview-list-item\n            #listComponent\n            *ngFor="let entity of filteredEntities$ | async; trackBy: trackByFn"\n            [entity]="entity"\n            [tc]="tc"\n            [dynamicRowComponent]="config?.dynamicRowComponent"\n          >\n          </sof-overview-list-item>\n        </sof-in-view>\n      </ng-container>\n      <ng-template #noResults>\n        <ng-container *ngIf="entities$ | async as entities">\n          <ng-container *ngIf="entities?.length > 0; else noData">\n            {{ tc + \'.\' + \'SEARCH-NO-RESULTS\' | translate }}\n          </ng-container>\n          <ng-template #noData>\n            {{ tc + \'.\' + \'SEARCH-NO-DATA\' | translate }}\n          </ng-template>\n        </ng-container>\n      </ng-template>\n    </ng-container>\n  ',providers:[{provide:n.SOF_FOCUS_COMPONENT,useExisting:y}]}]}],e.OverviewListComponent.ctorParameters=function(){return[{type:o.Router},{type:o.ActivatedRoute}]},e.OverviewListComponent.propDecorators={tc:[{type:t.Input}],config:[{type:t.Input}],entities:[{type:t.Input}],groupDefinitions:[{type:t.Input}],thresholdNumberOfItems:[{type:t.Input}],groupSelector:[{type:t.Input}],enableSearch:[{type:t.Input}],enableSorting:[{type:t.Input}],retainGroupSelection:[{type:t.Input}],searchedEntities:[{type:t.Output}],searchBarComponent:[{type:t.ViewChild,args:["searchBarComponent"]}],listComponents:[{type:t.ViewChildren,args:["listComponent"]}]},e.OverviewListComponent=y=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s}([r.UntilDestroy()],e.OverviewListComponent);var w=function(){function e(e,t,o){this.componentFactoryResolver=e,this.viewContainerRef=t,this.interactivityChecker=o}return Object.defineProperty(e.prototype,"tc",{set:function(e){this.localTc=e,this.componentRef&&(this.componentRef.instance.tc=this.localTc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"entity",{set:function(e){this.localEntity=e,this.componentRef&&(this.componentRef.instance.entity=this.localEntity)},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){var e=this.componentFactoryResolver.resolveComponentFactory(this.dynamicRowComponent);this.componentRef=this.viewContainerRef.createComponent(e),this.componentRef.instance.tc=this.localTc,this.componentRef.instance.entity=this.localEntity},e.prototype.sofFocus=function(){var e;if(this.componentRef.instance&&"function"==typeof this.componentRef.instance.sofFocus)this.componentRef.instance.sofFocus();else if(this.interactivityChecker.isFocusable(this.componentRef.location.nativeElement))this.componentRef.location.nativeElement.focus();else{if(!this.interactivityChecker.isFocusable(null===(e=this.componentRef.location.nativeElement)||void 0===e?void 0:e.firstChild))throw Error("The dynamic row component nor its first child is focusable.");this.componentRef.location.nativeElement.firstChild.focus()}},e}();w.decorators=[{type:t.Component,args:[{selector:"sof-overview-list-item",changeDetection:t.ChangeDetectionStrategy.OnPush,template:"",providers:[{provide:n.SOF_FOCUS_COMPONENT,useExisting:w}],styles:[""]}]}],w.ctorParameters=function(){return[{type:t.ComponentFactoryResolver},{type:t.ViewContainerRef},{type:d.InteractivityChecker}]},w.propDecorators={tc:[{type:t.Input}],entity:[{type:t.Input}],dynamicRowComponent:[{type:t.Input}]};var b=function(){};b.decorators=[{type:t.NgModule,args:[{declarations:[w],exports:[w],imports:[a.CommonModule]}]}];var S=function(){};S.decorators=[{type:t.NgModule,args:[{declarations:[e.OverviewListComponent],exports:[e.OverviewListComponent],imports:[a.CommonModule,b,p.LoadingModule,h.OverviewListSearchBarModule,f.OverviewListGroupFilterModule,u.TranslateModule,m.OverviewListSortDropdownModule,l.InViewModule]}]}];var k=function(){function e(){}return e.prototype.createConfig=function(){return new v.OverviewListConfig},e}();k.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new k},token:k,providedIn:"root"}),k.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.OverviewListConfigBuilder=k,e.OverviewListModule=S,e.ɵa=b,e.ɵb=w,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=sofico-framework-ui-kit-components-overview-list.umd.min.js.map