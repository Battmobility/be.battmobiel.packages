{"version":3,"sources":["../../../../projects/sofico-framework/ui-kit/components/overview-list-sort-dropdown/overview-list-sort-dropdown.component.ts","../../../../projects/sofico-framework/ui-kit/components/overview-list-sort-dropdown/overview-list-sort-dropdown.module.ts"],"names":["OverviewListSortDropdownComponent","translateService","fb","this","form","control","changeSorting","EventEmitter","selectorLabel","x","translation","selectorValue","index","Object","defineProperty","prototype","config","selectors","_b","_a","functionalProps","filter","prop","sortable","map","selector","plainSorts","_d","_c","plainSort","labels","_f","_e","label","dropDownChoices$","mapToTranslatedDropDownChoices","changeDirection","emit","sorting","order","onChange","obj","_this","arrayReadyTranslate","tc","stream","pipe","keys","key","Component","args","changeDetection","ChangeDetectionStrategy","OnPush","template","TranslateService","FormBuilder","Input","Output","NgModule","declarations","exports","imports","CommonModule","SvgIconModule","TranslateModule","InputSingleSelectModule","FormsModule","ReactiveFormsModule","ButtonModule"],"mappings":"g3CA6EE,SAAAA,EACUC,EACAC,GADAC,KAAAF,iBAAAA,EACAE,KAAAD,GAAAA,EA1BVC,KAAAC,KAAOD,KAAKD,GAAGG,QAAQ,GAmBvBF,KAAAG,cAAgB,IAAIC,EAAAA,aAEpBJ,KAAAK,cAAgB,SAAAC,GAAK,OAAAA,MAAAA,OAAC,EAADA,EAAGC,aACxBP,KAAAQ,cAAgB,SAAAF,GAAK,OAAAA,MAAAA,OAAC,EAADA,EAAGG,cAjBxBC,OAAAC,eAAad,EAAAe,UAAA,qBAAkB,KAA/B,SAAgCC,mBAC9Bb,KAAKc,UAC2B,QADlBC,EAA0B,QAA1BC,EAAGH,MAAAA,OAAM,EAANA,EAAQI,uBAAe,IAAAD,OAAA,EAAAA,EACpCE,QAAO,SAAAC,GAAQ,OAAAA,EAAKC,mBAAQ,IAAAL,OAAA,EAAAA,EAC5BM,KAAI,SAAAF,GAAQ,OAAAA,MAAAA,OAAI,EAAJA,EAAMG,YACtBtB,KAAKuB,WAC2B,QADjBC,EAA0B,QAA1BC,EAAGZ,MAAAA,OAAM,EAANA,EAAQI,uBAAe,IAAAQ,OAAA,EAAAA,EACrCP,QAAO,SAAAC,GAAQ,OAAAA,EAAKC,mBAAQ,IAAAI,OAAA,EAAAA,EAC5BH,KAAI,SAAAF,GAAQ,OAAAA,MAAAA,OAAI,EAAJA,EAAMO,aACtB1B,KAAK2B,OAC2B,QADrBC,EAA0B,QAA1BC,EAAGhB,MAAAA,OAAM,EAANA,EAAQI,uBAAe,IAAAY,OAAA,EAAAA,EACjCX,QAAO,SAAAC,GAAQ,OAAAA,EAAKC,mBAAQ,IAAAQ,OAAA,EAAAA,EAC5BP,KAAI,SAAAF,GAAQ,OAAAA,MAAAA,OAAI,EAAJA,EAAMW,SACtB9B,KAAK+B,iBAAmB/B,KAAKgC,kEAc/BnC,EAAAe,UAAAqB,gBAAA,qBACEjC,KAAKG,cAAc+B,KAAK,CACtBf,KAAkB,QAAdH,EAAEhB,KAAKmC,eAAO,IAAAnB,OAAA,EAAAA,EAAEG,KACpBO,UAAuB,QAAdX,EAAEf,KAAKmC,eAAO,IAAApB,OAAA,EAAAA,EAAEW,UACzBU,MAA+B,SAAZ,QAAZX,EAAAzB,KAAKmC,eAAO,IAAAV,OAAA,EAAAA,EAAEW,OAAkB,OAAS,SAIpDvC,EAAAe,UAAAyB,SAAA,SAASC,SACPtC,KAAKG,cAAc+B,KAAK,CACtBf,KAAMnB,KAAKc,UAAUwB,EAAI7B,OACzBiB,UAAW1B,KAAKuB,WAAWe,EAAI7B,OAC/B2B,MAAmB,QAAdpB,EAAEhB,KAAKmC,eAAO,IAAAnB,OAAA,EAAAA,EAAEoB,SAIzBvC,EAAAe,UAAAoB,+BAAA,WAAA,IAAAO,EAAAvC,KAGQwC,EAAsBxC,KAAK2B,OAAON,KAAI,SAAAS,GAAS,OAAAS,EAAKE,GAAK,IAAMX,KACrE,OAAO9B,KAAKF,iBAAiB4C,OAAOF,GAAqBG,KACvDtB,EAAAA,KAAI,SAAAiB,GACF,OAAA5B,OAAOkC,KAAKN,GAAKjB,KAAI,SAACwB,EAAKpC,GACzB,MAAO,CACLF,YAAa+B,EAAIO,GACjBpC,MAAKA,oCA7FhBqC,EAAAA,UAASC,KAAA,CAAC,CACTzB,SAAU,kCACV0B,gBAAiBC,EAAAA,wBAAwBC,OACzCC,SAAU,0iCATHC,EAAAA,wBADAC,EAAAA,2CAgDNC,EAAAA,uBACAA,EAAAA,kCAEAA,EAAAA,6BAaAC,EAAAA,gBCjDH,iCAbCC,EAAAA,SAAQT,KAAA,CAAC,CACRU,aAAc,CAAC5D,GACf6D,QAAS,CAAC7D,GACV8D,QAAS,CACPC,EAAAA,aACAC,EAAAA,cACAC,EAAAA,gBACAC,EAAAA,wBACAC,EAAAA,YACAC,EAAAA,oBACAC,EAAAA","sourcesContent":["import {\n  ChangeDetectionStrategy,\n  Component,\n  EventEmitter,\n  Input,\n  Output\n} from '@angular/core';\nimport { FormBuilder } from '@angular/forms';\nimport { TranslateService } from '@ngx-translate/core';\nimport { OverviewListConfig } from '@sofico-framework/ui-kit/classes';\nimport { SortingOrderConfig } from '@sofico-framework/utils';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\n@Component({\n  selector: 'sof-overview-list-sort-dropdown',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  template: `\n    <div class=\"input-group mb-3\">\n      <div class=\"input-group-prepend\">\n        <button\n          sofButton\n          [icon]=\"\n            sorting?.order === 'asc'\n              ? 'icon-sort-amount-asc'\n              : 'icon-sort-amount-desc'\n          \"\n          class=\"btn\"\n          type=\"button\"\n          (click)=\"changeDirection()\"\n        ></button>\n      </div>\n      <sof-input-single-select\n        [tc]=\"tc\"\n        class=\"form-control\"\n        [formControl]=\"form\"\n        [options]=\"dropDownChoices$ | async\"\n        [selectorLabel]=\"selectorLabel\"\n        [selectorValue]=\"selectorValue\"\n        [clearable]=\"false\"\n        [showSearch]=\"false\"\n        (changeObjectValue)=\"onChange($event)\"\n      ></sof-input-single-select>\n    </div>\n  `,\n  styleUrls: ['./overview-list-sort-dropdown.component.scss']\n})\nexport class OverviewListSortDropdownComponent<T> {\n  labels: string[];\n  plainSorts: boolean[];\n  selectors: ((entity: T) => any)[];\n  dropDownChoices$: Observable<{ translation: string; index: number }[]>;\n\n  form = this.fb.control(0);\n\n  @Input() tc: string;\n  @Input() sorting: SortingOrderConfig<T>;\n\n  @Input() set overviewListConfig(config: OverviewListConfig<T>) {\n    this.selectors = config?.functionalProps\n      ?.filter(prop => prop.sortable)\n      ?.map(prop => prop?.selector);\n    this.plainSorts = config?.functionalProps\n      ?.filter(prop => prop.sortable)\n      ?.map(prop => prop?.plainSort);\n    this.labels = config?.functionalProps\n      ?.filter(prop => prop.sortable)\n      ?.map(prop => prop?.label);\n    this.dropDownChoices$ = this.mapToTranslatedDropDownChoices();\n  }\n\n  @Output()\n  changeSorting = new EventEmitter<SortingOrderConfig<T>>();\n\n  selectorLabel = x => x?.translation;\n  selectorValue = x => x?.index;\n\n  constructor(\n    private translateService: TranslateService,\n    private fb: FormBuilder\n  ) {}\n\n  changeDirection(): void {\n    this.changeSorting.emit({\n      prop: this.sorting?.prop,\n      plainSort: this.sorting?.plainSort,\n      order: this.sorting?.order === 'asc' ? 'desc' : 'asc'\n    });\n  }\n\n  onChange(obj: { translation: string; index: number }): void {\n    this.changeSorting.emit({\n      prop: this.selectors[obj.index],\n      plainSort: this.plainSorts[obj.index],\n      order: this.sorting?.order\n    });\n  }\n\n  mapToTranslatedDropDownChoices(): Observable<\n    { translation: string; index: number }[]\n  > {\n    const arrayReadyTranslate = this.labels.map(label => this.tc + '.' + label);\n    return this.translateService.stream(arrayReadyTranslate).pipe(\n      map(obj =>\n        Object.keys(obj).map((key, index) => {\n          return {\n            translation: obj[key],\n            index\n          };\n        })\n      )\n    );\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { ButtonModule } from '@sofico-framework/ui-kit/components/button';\nimport { InputSingleSelectModule } from '@sofico-framework/ui-kit/components/input-single-select';\nimport { SvgIconModule } from '@sofico-framework/ui-kit/components/svg-icon';\nimport { OverviewListSortDropdownComponent } from './overview-list-sort-dropdown.component';\n\n@NgModule({\n  declarations: [OverviewListSortDropdownComponent],\n  exports: [OverviewListSortDropdownComponent],\n  imports: [\n    CommonModule,\n    SvgIconModule,\n    TranslateModule,\n    InputSingleSelectModule,\n    FormsModule,\n    ReactiveFormsModule,\n    ButtonModule\n  ]\n})\nexport class OverviewListSortDropdownModule {}\n"]}