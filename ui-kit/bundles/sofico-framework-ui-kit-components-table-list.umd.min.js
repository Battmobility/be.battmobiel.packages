!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@sofico-framework/ui-kit/directives/focus"),require("@sofico-framework/utils"),require("ngx-reactivetoolkit"),require("rxjs"),require("rxjs/operators"),require("@angular/common"),require("@ngx-translate/core"),require("@sofico-framework/ui-kit/components/loading"),require("@sofico-framework/ui-kit/components/svg-icon"),require("@sofico-framework/ui-kit/components/table-list-search-bar")):"function"==typeof define&&define.amd?define("@sofico-framework/ui-kit/components/table-list",["exports","@angular/core","@sofico-framework/ui-kit/directives/focus","@sofico-framework/utils","ngx-reactivetoolkit","rxjs","rxjs/operators","@angular/common","@ngx-translate/core","@sofico-framework/ui-kit/components/loading","@sofico-framework/ui-kit/components/svg-icon","@sofico-framework/ui-kit/components/table-list-search-bar"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self)["sofico-framework"]=t["sofico-framework"]||{},t["sofico-framework"]["ui-kit"]=t["sofico-framework"]["ui-kit"]||{},t["sofico-framework"]["ui-kit"].components=t["sofico-framework"]["ui-kit"].components||{},t["sofico-framework"]["ui-kit"].components["table-list"]={}),t.ng.core,t["sofico-framework"]["ui-kit"].directives.focus,t.utils,t.ngxReactivetoolkit,t.rxjs,t.rxjs.operators,t.ng.common,t.core,t["sofico-framework"]["ui-kit"].components.loading,t["sofico-framework"]["ui-kit"].components["svg-icon"],t["sofico-framework"]["ui-kit"].components["table-list-search-bar"])}(this,(function(t,e,n,o,i,r,s,a,c,l,u,p){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */Object.create;function f(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,i,r=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(t){i={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return s}var h;Object.create;t.TableListComponent=h=function(){function t(){this.entities$=new r.ReplaySubject(1),this.config$=new r.ReplaySubject(1),this.thresholdNumberOfItems=15,this.enableSearch=!0,this.enableSorting=!0,this.searchedEntities=new e.EventEmitter,this.termSub$=new r.BehaviorSubject(""),this.sortingSub$=new r.BehaviorSubject(null),this.numberOfItemsToDisplaySub$=new r.BehaviorSubject(this.thresholdNumberOfItems),this.trackByFn=function(t){return t}}return Object.defineProperty(t.prototype,"config",{set:function(t){var e,n,o,i;t&&(this.config$.next(t),this.sortingSub$.next(t.initialSorting),this.searchableSelectors=t.functionalProps.filter((function(t){return t.searchable})).map((function(t){return t.selector})),this.selectors=null===(n=null===(e=null==t?void 0:t.functionalProps)||void 0===e?void 0:e.filter((function(t){return t.sortable})))||void 0===n?void 0:n.map((function(t){return null==t?void 0:t.selector})),this.plainSorts=null===(i=null===(o=null==t?void 0:t.functionalProps)||void 0===o?void 0:o.filter((function(t){return t.sortable})))||void 0===i?void 0:i.map((function(t){return null==t?void 0:t.plainSort})),t.initialSorting&&(this.activeSortPropId=t.initialSortingFuncPropRef.id))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entities",{set:function(t){t&&this.entities$.next(t)},enumerable:!1,configurable:!0}),t.prototype.sofFocus=function(){this.enableSearch&&this.searchBarComponent.sofFocus()},t.prototype.ngOnInit=function(){var t=this;this.searchedEntities$=this.getSearchedEntities$(),this.searchedEntities$.pipe(i.takeUntilDestroy(this)).subscribe((function(e){return t.searchedEntities.emit(e)})),this.sortedEntities$=this.getSortedEntities$(),this.hasSearchedEntities=this.getHasEntities$()},t.prototype.ngOnDestroy=function(){},t.prototype.onChangeSorting=function(t,e){this.sortingSub$.next({prop:this.selectors[e],plainSort:this.plainSorts[e],order:t===this.activeSortPropId&&"asc"===this.sortingSub$.getValue().order?"desc":"asc"}),this.activeSortPropId=t},t.prototype.onChangeTerm=function(t){this.termSub$.next(t),this.numberOfItemsToDisplaySub$.next(this.thresholdNumberOfItems),this.getSearchedEntities$()},t.prototype.getSearchedEntities$=function(){var t=this;return this.entities$.pipe(s.switchMap((function(e){return t.enableSearch&&0!==t.searchableSelectors.length?r.of(e).pipe(o.search(t.termSub$,t.searchableSelectors)):r.of(e)})),s.shareReplay({refCount:!0,bufferSize:1}))},t.prototype.getSortedEntities$=function(){return r.combineLatest([this.entities$,this.sortingSub$]).pipe(s.map((function(t){var e=f(t,2),n=e[0],i=e[1];return o.sortList(n,i)})))},t.prototype.getHasEntities$=function(){return this.searchedEntities$.pipe(s.map((function(t){return(null==t?void 0:t.length)>0})),s.shareReplay({refCount:!0,bufferSize:1}))},t}(),t.TableListComponent.decorators=[{type:e.Component,args:[{selector:"sof-table-list",changeDetection:e.ChangeDetectionStrategy.OnPush,template:'\n    <ng-container *ngIf="config$ | async as config">\n      <div *ngIf="enableSearch" class="w-100">\n        <sof-table-list-search-bar\n          #searchBarComponent\n          [tc]="tc"\n          (changeTerm)="onChangeTerm($event)"\n        ></sof-table-list-search-bar>\n      </div>\n      <ng-container *ngIf="hasSearchedEntities | async; else noResults">\n        <div class="table-responsive">\n          <table class="table table-borderless table-striped">\n            <thead>\n              <tr>\n                <th\n                  *ngFor="let prop of config.functionalProps; let i = index"\n                  (click)="onChangeSorting(prop.id, i)"\n                >\n                  <div class="d-flex">\n                    <div>{{ tc + \'.\' + prop.header | translate }}</div>\n                    <sof-svg-icon\n                      class="ml-1"\n                      [class.visibility-hidden]="activeSortPropId !== prop.id"\n                      [icon]="\n                        (sortingSub$ | async)?.order === \'asc\'\n                          ? \'icon-sort-amount-asc\'\n                          : \'icon-sort-amount-desc\'\n                      "\n                      size="12"\n                    ></sof-svg-icon>\n                  </div>\n                </th>\n              </tr>\n            </thead>\n            <tbody>\n              <sof-table-list-item\n                *ngFor="\n                  let entity of searchedEntities$\n                    | async\n                    | sofSort: (sortingSub$ | async);\n                  trackBy: trackByFn\n                "\n                [entity]="entity"\n                [tc]="tc"\n                [dynamicRowComponent]="config?.dynamicRowComponent"\n              >\n              </sof-table-list-item>\n            </tbody>\n          </table>\n        </div>\n      </ng-container>\n      <ng-template #noResults>\n        <ng-container *ngIf="entities$ | async as entities">\n          <ng-container *ngIf="entities?.length > 0; else noData">\n            {{ tc + \'.\' + \'SEARCH-NO-RESULTS\' | translate }}\n          </ng-container>\n          <ng-template #noData>\n            {{ tc + \'.\' + \'SEARCH-NO-DATA\' | translate }}\n          </ng-template>\n        </ng-container>\n      </ng-template>\n    </ng-container>\n  ',providers:[{provide:n.SOF_FOCUS_COMPONENT,useExisting:h}],styles:[".visibility-hidden{visibility:hidden}thead>tr{cursor:pointer}.table-responsive sof-svg-icon{align-self:center}.no-results{margin-left:.75rem}"]}]}],t.TableListComponent.propDecorators={thresholdNumberOfItems:[{type:e.Input}],tc:[{type:e.Input}],config:[{type:e.Input}],entities:[{type:e.Input}],enableSearch:[{type:e.Input}],enableSorting:[{type:e.Input}],searchedEntities:[{type:e.Output}],searchBarComponent:[{type:e.ViewChild,args:["searchBarComponent"]}]},t.TableListComponent=h=function(t,e,n,o){var i,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,n,s):i(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s}([i.UntilDestroy()],t.TableListComponent);var d=function(){function t(t,e){this.componentFactoryResolver=t,this.viewContainerRef=e}return Object.defineProperty(t.prototype,"tc",{set:function(t){this.localTc=t,this.componentRef&&(this.componentRef.instance.tc=this.localTc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entity",{set:function(t){this.localEntity=t,this.componentRef&&(this.componentRef.instance.entity=this.localEntity)},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){var t=this.componentFactoryResolver.resolveComponentFactory(this.dynamicRowComponent);this.componentRef=this.viewContainerRef.createComponent(t),this.componentRef.instance.tc=this.localTc,this.componentRef.instance.entity=this.localEntity},t}();d.decorators=[{type:e.Component,args:[{selector:"sof-table-list-item",changeDetection:e.ChangeDetectionStrategy.OnPush,template:"",styles:[""]}]}],d.ctorParameters=function(){return[{type:e.ComponentFactoryResolver},{type:e.ViewContainerRef}]},d.propDecorators={tc:[{type:e.Input}],entity:[{type:e.Input}],dynamicRowComponent:[{type:e.Input}]};var m=function(){};m.decorators=[{type:e.NgModule,args:[{declarations:[d],exports:[d],imports:[a.CommonModule]}]}];var g=function(){};g.decorators=[{type:e.NgModule,args:[{declarations:[t.TableListComponent],imports:[a.CommonModule,p.TableListSearchBarModule,l.LoadingModule,c.TranslateModule,o.UtilsPipesModule,u.SvgIconModule,m],exports:[t.TableListComponent]}]}];var b=function(){function t(){this.functionalProps=[],this.initialSorting={prop:null},this.dynamicRowComponent=null,this.initialSortingFuncPropRef=null,this.functionalPropCount=0}return t.prototype.setDynamicRowComponent=function(t){return this.dynamicRowComponent=t,this},t.prototype.withNaturalSorting=function(){var t=this.functionalProps[this.functionalProps.length-1];return t.sortable=!0,t.plainSort=!1,this.initialSortingFuncPropRef&&(this.initialSortingFuncPropRef.plainSort=t.plainSort),this},t.prototype.withPlainSorting=function(t){var e=this.functionalProps[this.functionalProps.length-1];return e.sortable=!0,e.plainSort=!0,this.initialSortingFuncPropRef&&(this.initialSortingFuncPropRef.plainSort=e.plainSort),this},t.prototype.asInitialSorting=function(t){var e=this.functionalProps[this.functionalProps.length-1];return this.initialSorting={prop:e.selector,order:t,plainSort:e.plainSort},this.initialSortingFuncPropRef=e,this},t.prototype.addFunctionalProp=function(t){return this.functionalProps.push({id:this.functionalPropCount,header:"",selector:t,searchable:!1,sortable:!1,plainSort:!1}),this.functionalPropCount++,this},t.prototype.setHeader=function(t){return this.functionalProps[this.functionalProps.length-1].header=t,this},t.prototype.withSearch=function(){return this.functionalProps[this.functionalProps.length-1].searchable=!0,this},t}(),y=function(){function t(){}return t.prototype.createConfig=function(){return new b},t}();y.ɵprov=e.ɵɵdefineInjectable({factory:function(){return new y},token:y,providedIn:"root"}),y.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.TableListConfig=b,t.TableListConfigBuilder=y,t.TableListModule=g,t.ɵa=m,t.ɵb=d,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=sofico-framework-ui-kit-components-table-list.umd.min.js.map